@{
    ViewBag.Title = "Dashboard | Portal Legisig";
}
@section styles{
    @Styles.Render("~/coreui/ladda/css")
    @Styles.Render("~/coreui/datatables/css")
    <link href="~/coreuilib/spinkit/css/spinkit.css" rel="stylesheet" />
    <style>
        .dataTable tr {
            text-align: center;
        }

        .col-form-label {
            font-size: 17px;
        }
    </style>
}
@section breadcrumb{
    <!-- Breadcrumb-->
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "Home")">Dashboard</a>
        </li>

        <!-- Breadcrumb Menu-->
        <li class="breadcrumb-menu d-md-down-none">
            <div class="btn-group" role="group" aria-label="Button group">
                <a class="btn" href="javascript:void(0)">
                    Olá @User.Identity.Name !
                </a>
            </div>
        </li>
    </ol>
}

<link href="~/Content/bootstrap-theme.min.css" rel="stylesheet" />

<div class="animated fadeIn">

    <script src="~/Scripts/chart/exporting.js"></script>
    <script src="~/Scripts/chart/highcharts.js"></script>
    <div class="card">
        <div class="card-body">
            <div class="row">
                <div class="col-sm-6">
                    <div class="box">
                        <div id="container"></div>
                    </div>
                </div>
                <!--/.col-->
                <div class="col-sm-6 d-md-block">
                    <div class="box">
                        <div id="container2"></div>
                    </div>
                </div>
                <!--/.col-->
            </div>
            <script>
                $(document).ready(function () {
                    $.getJSON("/Dashboard/GetData", function (data) {



                        Highcharts.chart('container', {
                            chart: {
                                plotBackgroundColor: null,
                                plotBorderWidth: null,
                                plotShadow: false,
                                type: 'pie'
                            },
                            title: {
                                text: 'Legislação Aplicavel por Ambito'
                            },
                            tooltip: {
                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                    }
                                }
                            },
                            series: [{
                                name: 'Brands',
                                colorByPoint: true,
                                data: [{
                                    name: 'Estadual',
                                    y: data.total_estadual
                                }, {
                                    name: 'Municipal',
                                    y: data.total_municipal
                                }, {
                                    name: 'Federal',
                                    y: data.total_federal
                                }]
                            }]
                        });
                    });
                });
                $(document).ready(function () {
                    $.getJSON("/Dashboard/GetSistema", function (data) {

                        Highcharts.chart('container2', {
                            chart: {
                                plotBackgroundColor: null,
                                plotBorderWidth: null,
                                plotShadow: false,
                                type: 'pie'
                            },
                            title: {
                                text: 'Legislação Aplicavel por Sistema'
                            },
                            tooltip: {
                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                    }
                                }
                            },
                            series: [{
                                name: 'Percentual',
                                colorByPoint: true,
                                data: [{
                                    name: 'Meio Ambiente',
                                    y: data.total_MeioAmbiente
                                }, {
                                    name: 'Qualidade',
                                    y: data.total_Qualidade
                                }, {
                                    name: 'Segurança e Saúde',
                                    y: data.total_SegurançaeSaude
                                }, {
                                    name: 'Responsabilidade Social',
                                    y: data.total_ResponsabilidadeSocial
                                }]
                            }]
                        });
                    });
                });
            </script>
        </div>
    </div>
    <div class="card">
        <div class="card-body">
            <div class="row">
                <div class="col-sm-6">
                    <div class="box">
                        <div id="container3"></div>
                    </div>
                </div>
                <!--/.col-->
                <div class="col-sm-6 d-md-block">
                    <div class="box">
                        <div id="container4"></div>
                    </div>
                </div>
                <!--/.col-->
            </div>
            <script>
                $(document).ready(function () {
                    $.getJSON("/Dashboard/GetAplicabilidade", function (data) {

                        Highcharts.chart('container3', {
                            chart: {
                                plotBackgroundColor: null,
                                plotBorderWidth: null,
                                plotShadow: false,
                                type: 'pie'
                            },
                            title: {
                                text: 'Requisição por Aplicabilidade'
                            },
                            tooltip: {
                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                    }
                                }
                            },
                            series: [{
                                name: 'Percentual',
                                colorByPoint: true,
                                data: [{
                                    name: 'Aplicavel',
                                    y: data.total_Aplicabilidade
                                }, {
                                    name: 'Conhecimento',
                                    y: data.total_Conhecimento
                                }]
                            }]
                        });
                    });
                });
                $(document).ready(function () {
                    $.getJSON("/Dashboard/GetAvaliacoes", function (data) {

                        Highcharts.chart('container4', {
                            chart: {
                                plotBackgroundColor: null,
                                plotBorderWidth: null,
                                plotShadow: false,
                                type: 'pie'
                            },
                            title: {
                                text: 'Resultado das Avaliações'
                            },
                            tooltip: {
                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                    }
                                }
                            },
                            series: [{
                                name: 'Percentual',
                                colorByPoint: true,
                                data: [{
                                    name: 'Atende',
                                    y: data.total_Atende
                                }, {
                                    name: 'Não Informado',
                                        y: data.total_NaoInformado
                                }, {
                                    name: 'Atende Parcial',
                                        y: data.total_AtendeParcial
                                }, {
                                    name: 'Em Andamento',
                                        y: data.total_EmAndamento
                                }, {
                                    name: 'Não Aplicavel',
                                        y: data.total_NaoAplicavel
                                }]
                            }]
                        });
                    });
                });
            </script>
        </div>
    </div>
</div>

@*<div class="card">
        <div class="card-header">
            <h4 style="display: inline-block">Total de vendas por dia</h4>
        </div>
        <div class="card-body">
            <table id="gridVendas" class="display" width="100%"></table>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h4 style="display: inline-block">Total diário por loja</h4>
        </div>
        <div class="card-body">
            <table id="gridVendasPorLoja" class="display" width="100%"></table>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h4 style="display: inline-block">Total geral por loja</h4>
        </div>
        <div class="card-body">
            <table id="gridVendasMensalPorLoja" class="display" width="100%"></table>
        </div>
    </div>*@
@section modals{
    <div id="modal-section"></div>
}
@section scripts{
    @Scripts.Render("~/coreui/ladda/js")
    <script src="~/Scripts/viewsjs/index.js"></script>
    <script src="~/coreuilib/chart.js/js/Chart.min.js"></script>
    <script src="~/ContentLegado/Dashboard/js/moment.min.js"></script>
    <script src="~/Scripts/chartsjs/dashboard.v1.0.3.js"></script>
    <script src="~/Scripts/viewsjs/changeclient.js"></script>

    @Scripts.Render("~/coreui/datatables/js")
    <script>
        $(document).ready(function () {
            loadClientes();
            generateGraficoFaturamento('faturamentoClassificacao', 'chartFaturamentoClassificacao');
            generateGridVendas();
            setTimeout(function () {
                generateGridVendasPorLoja();
                generateGridVendasMensalPorLoja();
            }, 2000)

            jQuery.fn.dataTableExt.oSort['numeric-comma-asc'] = function (a, b) {
                var x = (a == "-") ? 0 : a.replace(".", "").replace(".", "").replace(/,/, ".");
                console.log(x);
                var y = (b == "-") ? 0 : b.replace(".", "").replace(".", "").replace(/,/, ".");
                x = parseFloat(x);
                y = parseFloat(y);
                return ((x < y) ? -1 : ((x > y) ? 1 : 0));
            };

            jQuery.fn.dataTableExt.oSort['numeric-comma-desc'] = function (a, b) {
                var x = (a == "-") ? 0 : a.replace(".", "").replace(".", "").replace(/,/, ".");
                var y = (b == "-") ? 0 : b.replace(".", "").replace(".", "").replace(/,/, ".");
                x = parseFloat(x);
                y = parseFloat(y);
                return ((x < y) ? 1 : ((x > y) ? -1 : 0));
            };
        })
    </script>
}